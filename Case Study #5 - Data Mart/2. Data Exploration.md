### 2. Data Exploration 

**1. What day of the week is used for each <code>week_date</code> value?**

````sql
select distinct
	to_char(to_date(week_date, 'dd/mm/yy'),'day') as day_of_week
from
	weekly_sales
````
Answer:
| day_of_week |
|-------------|
| monday      |


***
**2. What range of week numbers are missing from the dataset?**

````sql
select distinct 
	week_number 
from 
	clean_weekly_sales
order by 
	week_number 
````

Answer: 
| week_number |
|-------------|
|      13     |
|      14     |
|      15     |
|      16     |
|      17     |
|      18     |
|      19     |
|      20     |
|      21     |
|      22     |
|      23     |
|      24     |
|      25     |
|      26     |
|      27     |
|      28     |
|      29     |
|      30     |
|      31     |
|      32     |
|      33     |
|      34     |
|      35     |
|      36     |

Missing range of week numbers are 1-12 and 37-52. 
***

**3. How many total transactions were there for each year in the dataset?**

````sql
select
	calendar_year,
	count(*) as total_transatcions
from
	clean_weekly_sales cws 
group by
	calendar_year 
order by
	calendar_year
````

Answer:
| calendar_year | total_transactions |
|---------------|--------------------|
|      2018     |         5698       |
|      2019     |         5708       |
|      2020     |         5711       |


***

**4. What is the total sales for each region for each month?**

````sql
with new_table as(
select
	region,
	to_char(to_date(week_date, 'dd/mm/yy'),'month') as months,
	sales
from
	weekly_sales
)

select 
	region,
	months,
	sum(sales) as total_sales
from 
	new_table
group by
	region,
	months
order by
	region
````

Answer:
| region       | months    | total_sales  |
|--------------|-----------|--------------|
| AFRICA       | april     | 1911783504   |
| AFRICA       | march     |  567767480   |
| AFRICA       | may       | 1647244738   |
| AFRICA       | june      | 1767559760   |
| AFRICA       | september |  276320987   |
| AFRICA       | july      | 1960219710   |
| AFRICA       | august    | 1809596890   |
| ASIA         | july      | 1768844756   |
| ASIA         | april     | 1804628707   |
| ASIA         | may       | 1526285399   |
| ASIA         | september |  252836807   |
| ASIA         | june      | 1619482889   |
| ASIA         | august    | 1663320609   |
| ASIA         | march     |  529770793   |
| CANADA       | july      |  477134947   |
| CANADA       | may       |  412378365   |
| CANADA       | august    |  447073019   |
| CANADA       | march     |  144634329   |
| CANADA       | september |   69067959   |
| CANADA       | june      |  443846698   |
| CANADA       | april     |  484552594   |
| EUROPE       | april     |  127334255   |
| EUROPE       | september |   18877433   |
| EUROPE       | june      |  122813826   |
| EUROPE       | august    |  122102995   |
| EUROPE       | july      |  136757466   |
| EUROPE       | may       |  109338389   |
| EUROPE       | march     |   35337093   |
| OCEANIA      | september |  372465518   |
| OCEANIA      | may       | 2215657304   |
| OCEANIA      | april     | 2599767620   |
| OCEANIA      | august    | 2432313652   |
| OCEANIA      | july      | 2563459400   |
| OCEANIA      | march     |  783282888   |
| OCEANIA      | june      | 2371884744   |
| SOUTH AMERICA| august    |  221166052   |
| SOUTH AMERICA| june      |  218247455   |
| SOUTH AMERICA| may       |  201391809   |
| SOUTH AMERICA| march     |   71023109   |
| SOUTH AMERICA| april     |  238451531   |
| SOUTH AMERICA| september |   34175583   |
| SOUTH AMERICA| july      |  235582776   |
| USA          | march     |  225353043   |
| USA          | april     |  759786323   |
| USA          | september |  110532368   |
| USA          | august    |  712002790   |
| USA          | july      |  760331754   |
| USA          | june      |  703878990   |
| USA          | may       |  655967121   |

***

**5. What is the total count of transactions for each platform**

````sql
select
	platform,
	count(*) as transactions_count
from
	weekly_sales
group by
	platform
````

Answer:
| platform | transactions_count |
|----------|--------------------|
| Shopify  |               8549 |
| Retail   |               8568 |

***

**6. What is the percentage of sales for Retail vs Shopify for each month?**

````sql
with new_table as(
select
	platform,
	to_char(to_date(week_date, 'dd/mm/yy'),'month') as months,
	sales
from
	weekly_sales
),
-- finding total sales of each month
total_sales as (
select 
	months,
	sum(sales) as total_sales
from 
	new_table
group by
	months
),
-- fidning total sale of each month with each platform
total_sale_per_month as (
select 
	platform,
	months,
	sum(sales) as total_sales
from 
	new_table
group by
	platform,
	months
)
-- join 2 CTEs and calculate the percentage for each platform of each month
select
	ts.months,
	tspm.platform,
	round((tspm.total_sales::numeric /ts.total_sales)*100,2) as percentage 
from
	total_sales ts
join 
	total_sale_per_month tspm 
on 
	ts.months = tspm.months
order by
	ts.months
````

Answer:
| months    | platform | percentage |
|-----------|----------|------------|
| april     | Shopify  |       2.41 |
| april     | Retail   |      97.59 |
| august    | Shopify  |       2.92 |
| august    | Retail   |      97.08 |
| july      | Retail   |      97.29 |
| july      | Shopify  |       2.71 |
| june      | Shopify  |       2.73 |
| june      | Retail   |      97.27 |
| march     | Shopify  |       2.46 |
| march     | Retail   |      97.54 |
| may       | Retail   |      97.30 |
| may       | Shopify  |       2.70 |
| september | Retail   |      97.38 |
| september | Shopify  |       2.62 |

***

**7. What is the percentage of sales by demographic for each year in the dataset?**

***

**8. Which <code>age_band</code>  and <code>demographic</code>  values contribute the most to Retail sales?**

***

**9. Can we use the <code>avg_transaction</code> column to find the average transaction size for each year for Retail vs Shopify? If not - how would you calculate it instead?**
